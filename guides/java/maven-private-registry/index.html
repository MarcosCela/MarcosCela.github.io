<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Wiki | Setting up a private maven mirror</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.81.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link href=/dist/css/app.955516233bcafa4d2a1c13cea63c7b50.css rel=stylesheet><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon><meta property="og:title" content="Setting up a private maven mirror"><meta property="og:description" content="Setting up a private maven mirror, for faster downloads and reduced latency wen downloading dependencies."><meta property="og:type" content="article"><meta property="og:url" content="https://wiki.mcela.dev/guides/java/maven-private-registry/"><meta property="article:section" content="guides"><meta property="article:published_time" content="2019-03-04T00:00:00+00:00"><meta property="article:modified_time" content="2019-03-04T00:00:00+00:00"><meta itemprop=name content="Setting up a private maven mirror"><meta itemprop=description content="Setting up a private maven mirror, for faster downloads and reduced latency wen downloading dependencies."><meta itemprop=datePublished content="2019-03-04T00:00:00+00:00"><meta itemprop=dateModified content="2019-03-04T00:00:00+00:00"><meta itemprop=wordCount content="340"><meta itemprop=keywords content="maven,java,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setting up a private maven mirror"><meta name=twitter:description content="Setting up a private maven mirror, for faster downloads and reduced latency wen downloading dependencies."></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://wiki.mcela.dev/images/java/maven.png)><div class="pb3-m pb6-l bg-black-60"><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=https://wiki.mcela.dev/ class="f3 fw2 hover-white no-underline white-90 dib">Wiki</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/guides/ title="Guides page">Guides</a></li></ul><a href=https://es.linkedin.com/in/marcoscelalopez target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=http://github.com/MarcosCela target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://gitlab.com/Marcos.Cela target=_blank class="link-transition gitlab link dib z-999 pt3 pt0-l mr1" title="Gitlab link" rel=noopener aria-label="follow on Gitlab——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg"><path d="M29.782 199.732 256 493.714 8.074 309.699c-6.856-5.142-9.712-13.996-7.141-21.993l28.849-87.974zm75.405-174.806c-3.142-8.854-15.709-8.854-18.851.0L29.782 199.732h131.961L105.187 24.926zm56.556 174.806L256 493.714l94.257-293.982H161.743zm349.324 87.974-28.849-87.974L256 493.714l247.926-184.015c6.855-5.142 9.711-13.996 7.141-21.993zm-85.404-262.78c-3.142-8.854-15.709-8.854-18.851.0l-56.555 174.806h131.961L425.663 24.926z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"><h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Setting up a private maven mirror</h1><h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">Setting up a private maven mirror, for faster downloads and reduced latency wen downloading dependencies.</h2></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><p class="f6 b helvetica tracked">GUIDES</p><h1 class="f1 athelas mb1">Setting up a private maven mirror</h1><time class="f6 mv4 dib tracked" datetime=2019-03-04T00:00:00Z>March 4, 2019</time>
<span class="f6 mv4 dib tracked">- 2 minutes read</span>
<span class="f6 mv4 dib tracked">- 340 words</span></header><section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-auto-l"><h1 id=what-is-a-private-maven-mirror>What is a private Maven mirror?</h1><p>When you download dependencies with maven, you usually do it via <a href=https://search.maven.org/>maven central</a>, and this
might not be the best solution. Having a local copy of the maven repository is specially
useful if you continually need to download dependencies:</p><ul><li>You avoid going through the internet, this can have a huge impact in the speed
at you download dependencies.</li><li>If you have a CI system that &ldquo;starts from scratch&rdquo; because it uses VM&rsquo;s or containers on
demand and always starts from a fresh filesystem, you will need to download dependencies
every time. This is one of the places where you will see a bigger difference.</li></ul><h1 id=how-does-it-work>How does it work?</h1><p>The usual implementations rely on a local cache. This means that every time you download
a dependency, your mirror will download it from the central maven repository, save it, and
then serve it to you. Subsequent downloads of the same dependency will not be downloaded again,
and therefore you save time, bandwidth, and increase your coolness factor (results may vary).</p><h1 id=actual-tutorial>Actual tutorial</h1><p>Okey, maven saves configuration files in <em><strong>~/.m2/settings.xml</strong></em>, so we go there and
do domething like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;settings</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://maven.apache.org/SETTINGS/1.0.0&#34;</span> 
  <span style=color:#a6e22e>xmlns:xsi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> 
  <span style=color:#a6e22e>xsi:schemaLocation=</span><span style=color:#e6db74>&#34;http://maven.apache.org/SETTINGS/1.0.0
</span><span style=color:#e6db74>  https://maven.apache.org/xsd/settings-1.0.0.xsd&#34;</span><span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;servers&gt;</span>
    <span style=color:#f92672>&lt;server&gt;</span>
      <span style=color:#f92672>&lt;id&gt;</span>central-mirror<span style=color:#f92672>&lt;/id&gt;</span>
      <span style=color:#f92672>&lt;username&gt;</span>myuser<span style=color:#f92672>&lt;/username&gt;</span>
      <span style=color:#f92672>&lt;password&gt;</span>{encrypted password}<span style=color:#f92672>&lt;/password&gt;</span>
    <span style=color:#f92672>&lt;/server&gt;</span>
  <span style=color:#f92672>&lt;/servers&gt;</span>

  <span style=color:#f92672>&lt;mirrors&gt;</span>
    <span style=color:#f92672>&lt;mirror&gt;</span>
      <span style=color:#f92672>&lt;id&gt;</span>central-mirror<span style=color:#f92672>&lt;/id&gt;</span>
      <span style=color:#f92672>&lt;name&gt;</span>Maven central mirror<span style=color:#f92672>&lt;/name&gt;</span>
      <span style=color:#f92672>&lt;url&gt;</span>https://my.nexus.org/repository/maven-central<span style=color:#f92672>&lt;/url&gt;</span>
      <span style=color:#f92672>&lt;mirrorOf&gt;</span>central<span style=color:#f92672>&lt;/mirrorOf&gt;</span>
    <span style=color:#f92672>&lt;/mirror&gt;</span>
  <span style=color:#f92672>&lt;/mirrors&gt;</span>
<span style=color:#f92672>&lt;/settings&gt;</span>
</code></pre></div><p>And how the hell do you obtain the &ldquo;encrypted password&rdquo;, well, first of all you will
obtain a master maven password:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mvn --encrypt-master-password &lt;very safe password&gt;
&gt;<span style=color:#f92672>{</span>AvE5...ME<span style=color:#f92672>=}</span>
</code></pre></div><p>This basically creates a main encryption password, that is used to encrypt other passwords
so you don&rsquo;t store plaintext credentials in your <em><strong>setings.xml</strong></em>. This is useful because
you can then copy your <em><strong>setings.xml</strong></em> to your CI system (obviously NOT to a public
place, this is intended for your organization internal CI system)..</p><p>The given password goes in a <strong>~/.m2/settings-security.xml</strong> file like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;settingsSecurity&gt;</span>
  <span style=color:#f92672>&lt;master&gt;</span>{AvE5...ME=}<span style=color:#f92672>&lt;/master&gt;</span>
<span style=color:#f92672>&lt;/settingsSecurity&gt;</span>
</code></pre></div><p>With this file in place, you can then create your user password and encrypt it:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mvn --encrypt-password &lt;my-user-password&gt;
</code></pre></div><p>And off we go, you can now easily download dependencies using your private mirror.</p><ul class=pa0><li class=list><a href=/tags/maven class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">maven</a></li><li class=list><a href=/tags/java class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">java</a></li></ul><div class=mt6></div></section><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://wiki.mcela.dev/>&copy; 2021 Wiki</a><div><a href=https://es.linkedin.com/in/marcoscelalopez target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=http://github.com/MarcosCela target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://gitlab.com/Marcos.Cela target=_blank class="link-transition gitlab link dib z-999 pt3 pt0-l mr1" title="Gitlab link" rel=noopener aria-label="follow on Gitlab——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg"><path d="M29.782 199.732 256 493.714 8.074 309.699c-6.856-5.142-9.712-13.996-7.141-21.993l28.849-87.974zm75.405-174.806c-3.142-8.854-15.709-8.854-18.851.0L29.782 199.732h131.961L105.187 24.926zm56.556 174.806L256 493.714l94.257-293.982H161.743zm349.324 87.974-28.849-87.974L256 493.714l247.926-184.015c6.855-5.142 9.711-13.996 7.141-21.993zm-85.404-262.78c-3.142-8.854-15.709-8.854-18.851.0l-56.555 174.806h131.961L425.663 24.926z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></footer><script src=/dist/js/app.3fc0f988d21662902933.js></script></body></html>